![Download](https://github.githubassets.com/images/icons/emoji/unicode/23ec.png?v8) [Download Now](https://inflectra.github.io/DownGit/#/home?url=https://github.com/Inflectra/rapise-powerpack/tree/master/FileCompare)

# File Checkpoints for Rapise

This sample contains a library for doing file checkpoints for the following types of objects:


1. String
2. Text File
2. Binary File
3. PDF File

It is all done via set of methods of the `Checkpoint` global object:

![Checkpoint](img/CheckpointObj.jpg)

When checkpoint finds inconsistency in the file it is reported like that:

![Report](img/CheckpointFailure.jpg)

## Checkpoint formats

Checkpoint definition may come in 3 formats:
1. JSON
2. Excel
3. Plain text

Each has similar structure:
```javascript
	"data": [
        ...
		{
			"n": "001", // Line number
			"c": 1, 		// 1 - check this line, 0 - ignore this line
			"r": 0,			// 0 - treat 't' as a text for exact comparison. 1 - '1' is a regular expression
			"t": "Book Management"	// plain text or regular expression (depends on 'r').
		},
        ...
    }
```

The same checkpoint element has very similar look in Excel format:

![Excel](img/CheckopintExcel.jpg)

And in plain text format:

![TXT](img/CheckopintTxt.jpg)

The format is automatically derived from the file extension: `.json`, `.xlsx` or `.txt` correspondingly.

## Checkpoint creation

A checkpoint is supposed to be automatically generated by `Checkpoint` object and then manually modified to meet user's needs.

Simplest way to create a checkpoint is to pass `autoCreate=true` to any of the assertion methods, i.e.:

```javascript
    /* Validate invoice.txt with checkpoint.json.
     * if checkopint.json is not yet available, 
     * create a new one based on current contents
     * of the invoice.txt.
     */
	Checkpoint.AssertTextFile('checkpoint.json', 'invoice.txt', true);
```

First call to this method would create a new checkpoint file. You may tweak it later.

Sometimes you may need more control over checkpoint creation. For example, you want it to use regular expressions by default and read a text file in UTF8 format instead of default ASCII. In this case you may use the following special method:

```javascript
Checkpoint.CreateFromTextFile( 'checkoint.json', 'invoice.txt', /*asUtf8*/true, /**regex*/true);
```

# Using

To add a `Checkpoint` object into your framework simply copy or merge the [Lib](Lib) folder into your framework root.

> **Note:** You may change implementation of PDF reader used by the checkpoint library by defining a function implementation: `global.GetPdfFileFullText = function(/**string*/path) {/**TODO*/; return pdfText;}`

